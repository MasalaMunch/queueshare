"use strict";

const fs = require(`fs`);
const Path = require(`path`);
const Uuid = require(`uuid`);

const encoding = `utf8`;

module.exports = ({dir}) => {

    fs.mkdirSync(dir, {recursive: true});

    const file = Path.join(dir, `file`);

    let uudid;

    try {

        uudid = fs.readFileSync(file, {encoding});

    }
    catch (error) {

        if (error.code === `ENOENT`) {

            uudid = Uuid.v4();

            fs.writeFileSync(file, uudid, {encoding});

        }
        else {

            throw error;

        }

    }

    return uudid;

};