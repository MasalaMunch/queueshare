"use strict";

const assert = require(`assert`);
const SyncedStringTree = require(`./SyncedStringTree.js`);

module.exports = class extends SyncedStringTree {

    _Parsed (change) {

        const parsedChange = super._Parsed(change);

        let {value} = change;

        if (value !== undefined) {

            value = JSON.parse(JSON.stringify(value));

        }

        parsedChange.change.value = value;

        return parsedChange;

    }

    write (localChange) {

        assert(localChange.hasOwnProperty(`value`));

        super.write(localChange);

    }

};